{% extends 'base.html' %}
{% load static %}
{% block content %}
<script>
    var data={{data|safe}};

    document.onreadystatechange=function() {
        if (document.readyState=="complete") {
            init()
        }
    }

    function init() {
        var teamIds = Object.keys(data['Teams']);
        attachGameId(data['Game'][0])
        generateUserName(teamIds);

    }
    function attachGameId(id) {
        var form = document.getElementById('formUser');
        const hiddenField = document.createElement('input');
        hiddenField.type = 'hidden';
        hiddenField.name = 'gameId';
        hiddenField.value = id;
        form.appendChild(hiddenField);
    }
    
    function generateUserName(teamIds){
        var user = document.getElementById("username");

        var count = data ['Orphans'].length
        teamIds.forEach(element => {
            count += data ['Teams'][element].length
        });
        user.value = "User " + count;

    }

    function validateForm() {
        var user = document.getElementById('username');

    }
</script>
<body>
    <div>
        <p>Welcome to LEAD Trivia Night!</p>
        
        <form id="formUser" method="POST" onsubmit="return validateForm()" action="/app/lobby/">
            {% csrf_token %}
            <div id="userInfo">
                <p>Please select a user name:</p>
                <input type="text" id="username" class="infoitem" name ="userid" value = "User"></input>
            </div>
        </form>
    </div>
</body>
{% endblock %}